!function(){"use strict";class e{constructor(e,t,r,s,n){this._data=e,this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteClick=s,this._handleLikeClick=n,this.cardId=e._id,this._islike=e.islike}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__like"),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardElement.querySelector(".card__trash").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._imageElement.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)}))}generateCard(){return this._cardElement=this._getTemplate(),this._imageElement=this._cardElement.querySelector(".card__image"),this._imageElement.src=this._link,this._imageElement.alt=this._name,this._cardElement.querySelector(".card__name").textContent=this._name,this._setEventListeners(),this._cardElement}removeCard(){this._cardElement.remove(),this._cardElement=null}getId(){return this.cardId}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._submitButton=this._formElement.querySelector(this._submitButtonSelector)}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}_showInputError(e){this._errorMessageEl=this._formElement.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageEl.textContent=e.validationMessage,this._errorMessageEl.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageEl=this._formElement.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageEl.textContent=e.validationMessage,this._errorMessageEl.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_toggleButtonState(){this._hasInvalidInput(this._inputEls)?this.disableButton():this._enableButton()}_setEventListener(){this._inputEls=[...this._formElement.querySelectorAll(this._inputSelector)],this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._formElement.addEventListener("submit",(e=>{e.preventDefault()}))}resetValidation(){this._inputEls.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListener()}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEcsClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEcsClose)}_handleEcsClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.querySelector("#modal-close-button").addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()}))}}class s extends r{constructor(e){let{popupSelector:t,handleFormSubmit:r}=e;super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._popupInputs=this._popupForm.querySelectorAll(".modal__input"),this._popupButton=this._popupForm.querySelector(".modal__button"),this._handleFormSubmit=r}renderLoading(e){this._popupButton.textContent=e?"Saving...":"Submit"}_getInputValues(){const e={};return this._popupInputs.forEach((t=>{e[t.name]=t.value})),console.log("Form Input Values:",e),e}_setInputValues(e){this._popupInputs.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}}const n=document.querySelector("#profile-edit-button"),i=document.querySelector("#profile-form"),o=document.querySelector("#card-add-button"),a=document.querySelector("#add-card-form"),l=document.querySelector("#profile-title-input"),c=document.querySelector("#profile-description-input"),d=document.querySelector("#avatar-edit-button"),h=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error:${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.description})}).then(this._checkResponse)}editUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._checkResponse)}addNewCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}setCardLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t,headers:this._headers}).then(this._checkResponse)}getAppInfo(){}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f0236218-80b1-4e28-bbd2-7b2cb80c1217","Content-Type":"application/json"}}),u={};var _;_={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(_.formSelector)).forEach((e=>{const r=new t(_,e),s=e.getAttribute("id");u[s]=r,r.enableValidation()}));const m=new class{constructor(e,t,r){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.name,this._jobElement.textContent=e.description}setUserAvatar(e){this._avatarElement.src=e.avatar}}(".profile__name",".profile__description",".profile__avatar");h.getUserInfo().then((e=>{m.setUserInfo({name:e.name,description:e.about})})).catch((e=>{console.error(e)}));const p=new s({popupSelector:"#profile-edit-modal",handleFormSubmit:function(e){p.renderLoading(!0),h.editUserInfo(e).then((e=>{m.setUserInfo({name:e.name,description:e.about})})).catch((e=>{console.error(e)})).finally((()=>{p.renderLoading(!1)})),p.close()}});p.setEventListeners();const E=new s({popupSelector:"#card-add-modal",handleFormSubmit:function(e){const t=e.title,r=e.link;E.renderLoading(!0),h.addNewCard({name:t,link:r}).then((e=>{const t=k(e);S.addItem(t)})).catch((e=>{console.error(e)})).finally((()=>{E.renderLoading(!1)})),E.close(),a.reset(),u[a.getAttribute("id")].disableButton()}});E.setEventListeners();const v=new s({popupSelector:"#profile-avatar-modal",handleFormSubmit:function(e){v.renderLoading(!0),h.editUserAvatar(e).then((e=>{m.setUserAvatar({avatar:e.avatar})})).catch((e=>{console.error(e)})).finally((()=>{v.renderLoading(!1)})),v.close()}});v.setEventListeners();const f=new class extends r{constructor(e){super({popupSelector:e}),this._cardImage=this._popupElement.querySelector(".modal__exhibit-image")}open(e,t){this._cardImage.src=t,this._cardImage.alt=e,this._popupElement.querySelector(".modal__exhibit-image-name").textContent=e,super.open()}}("#image-modal");f.setEventListeners();const b=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._popupButton=this._popupElement.querySelector(".modal__button")}renderLoading(e){this._popupButton.textContent=e?"Deleting...":"Yes"}confirmDelete(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._popupButton.addEventListener("click",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}({popupSelector:"#confirmation-modal",handleFormSubmit:L});b.setEventListeners();const S=new class{constructor(e,t){let{renderer:r}=e;this._renderer=r,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:e=>{S.addItem(e)}},".cards__list");function g(e,t){f.open(e,t)}function k(t){return new e(t,"#card-template",g,L,y).generateCard()}function L(e){b.open(),b.confirmDelete((()=>{h.deleteCard(e.getId()).then((()=>{e.removeCard(),b.close()})).catch((e=>{console.error("Card deletion API failed:",e)}))}))}function y(e){const t=e._likeButton.classList.contains("card__like_active")?"DELETE":"PUT";h.setCardLike(e.getId(),t).then((()=>{e._likeButton.classList.toggle("card__like_active")})).catch((e=>{console.error("Like Button Error",e)}))}h.getInitialCards().then((e=>e.map((e=>({name:e.name,link:e.link,_id:e._id}))))).catch((e=>(console.error(e),[]))).then((e=>{const t=e.map((e=>k(e)));S.renderItems(t)})).catch((e=>{console.error(e)})),n.addEventListener("click",(()=>{!function(){const e=m.getUserInfo();l.value=e.name,c.value=e.job}(),u[i.getAttribute("id")].resetValidation(),p.open()})),o.addEventListener("click",(()=>{E.open()})),d.addEventListener("click",(()=>{v.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQ3pDc0osRUFBZ0IvRixNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2FwaS5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXB3aXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICApIHtcclxuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICB0aGlzLmNhcmRJZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5faXNsaWtlID0gZGF0YS5pc2xpa2U7XHJcbiAgfVxyXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBfZ2V0VGVtcGxhdGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIF9zZXRFdmVudExpc3RlbmVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvL2xpa2UgYnV0dG9uXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAvLyB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcclxuICAgIH0pO1xyXG4gICAgLy90cmFzaFxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2hcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcyk7XHJcbiAgICAgICAgLy90aGlzLl9oYW5kbGVUcmFzaEJ1dHRvbigpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvL2V4aGliaXRcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gSGFuZGxlciAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuICAvKl9oYW5kbGVMaWtlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZV9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICAvKlxyXG4gIF9oYW5kbGVUcmFzaEJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuKi9cclxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gZ2VuZXJhdGVDYXJkIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19uYW1lXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgZ2V0SWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5jYXJkSWQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gc2V0dGluZ3MuZm9ybVNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0RWxzLmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsLmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxzKSkge1xyXG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXIoKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVscyA9IFtcclxuICAgICAgLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSxcclxuICAgIF07XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXIoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRWNzQ2xvc2UpO1xyXG4gIH1cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRWNzQ2xvc2UpO1xyXG4gIH1cclxuICBfaGFuZGxlRWNzQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1jbG9zZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9KTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fcG9wdXBJbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcbiAgICB0aGlzLl9wb3B1cEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3BvcHVwQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3BvcHVwQnV0dG9uLnRleHRDb250ZW50ID0gXCJTdWJtaXRcIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcclxuXHJcbiAgICB0aGlzLl9wb3B1cElucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIGNvbnNvbGUubG9nKFwiRm9ybSBJbnB1dCBWYWx1ZXM6XCIsIGZvcm1WYWx1ZXMpO1xyXG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBfc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgdGhpcy5fcG9wdXBJbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEltcG9ydCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCBjb25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL2FwaS5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cHdpdGhDb25maXJtYXRpb24uanNcIjtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlZCBjb25zdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZm9ybVwiKTtcclxuY29uc3QgY2FyZEFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1hZGQtYnV0dG9uXCIpO1xyXG5jb25zdCBjYXJkQWRkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKTtcclxuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcclxuKTtcclxuY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWVkaXQtYnV0dG9uXCIpO1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPT1AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiZjAyMzYyMTgtODBiMS00ZTI4LWJiZDItN2IyY2I4MGMxMjE3XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBGb3JtVmFsaWRhdG9yKEZvcm0pIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtRWxlbWVudCk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcImlkXCIpO1xyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oY29uZmlnKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFVzZXJJbmZvIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IHByb2ZpbGVJbmZvID0gbmV3IFVzZXJJbmZvKFxyXG4gIFwiLnByb2ZpbGVfX25hbWVcIixcclxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG4gIFwiLnByb2ZpbGVfX2F2YXRhclwiXHJcbik7XHJcblxyXG5hcGlcclxuICAuZ2V0VXNlckluZm8oKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIHByb2ZpbGVJbmZvLnNldFVzZXJJbmZvKHsgbmFtZTogcmVzLm5hbWUsIGRlc2NyaXB0aW9uOiByZXMuYWJvdXQgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gIH0pO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFByb2ZpbGVQb3B1cCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0LFxyXG59KTtcclxucHJvZmlsZUVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGNhcmRBZGRQb3B1cCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgY2FyZEFkZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI2NhcmQtYWRkLW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlQ2FyZEFkZFN1Ym1pdCxcclxufSk7XHJcbmNhcmRBZGRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGF2YXRhclBvcHVwIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5jb25zdCBhdmF0YXJFZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjcHJvZmlsZS1hdmF0YXItbW9kYWxcIixcclxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVBdmF0YXJFZGl0U3VibWl0LFxyXG59KTtcclxuYXZhdGFyRWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFBvcHVwV2l0aEltYWdlIChDYXJkKS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IGNhcmRJbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLW1vZGFsXCIpO1xyXG5jYXJkSW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIERlbGV0ZUNvbmZpcm1Qb3B1cCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgZGVsZXRlQ29uZmlybVBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbih7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjY29uZmlybWF0aW9uLW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbn0pO1xyXG5kZWxldGVDb25maXJtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFNlY3Rpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuZnVuY3Rpb24gY2FyZExpc3REYXRhKCkge1xyXG4gIHJldHVybiBhcGlcclxuICAgIC5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gcmVzLm1hcCgoY2FyZCkgPT4gKHtcclxuICAgICAgICBuYW1lOiBjYXJkLm5hbWUsXHJcbiAgICAgICAgbGluazogY2FyZC5saW5rLFxyXG4gICAgICAgIF9pZDogY2FyZC5faWQsXHJcbiAgICAgIH0pKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5jb25zdCBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIHJlbmRlcmVyOiAoaXRlbXMpID0+IHtcclxuICAgICAgY2FyZExpc3QuYWRkSXRlbShpdGVtcyk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4pO1xyXG5cclxuY2FyZExpc3REYXRhKClcclxuICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkYXRhLm1hcCgoY2FyZERhdGEpID0+IGNyZWF0ZUNhcmQoY2FyZERhdGEpKTtcclxuICAgIGNhcmRMaXN0LnJlbmRlckl0ZW1zKGNhcmRFbGVtZW50KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgfSk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGdW5jdGlvbnMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gUHJvZmlsZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUZvcm0oKSB7XHJcbiAgY29uc3QgdXNlckRhdGEgPSBwcm9maWxlSW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZTtcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXJEYXRhLmpvYjtcclxufVxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIENhcmQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhuYW1lLCBsaW5rKSB7XHJcbiAgY2FyZEltYWdlUG9wdXAub3BlbihuYW1lLCBsaW5rKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmREYXRhLFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlTGlrZUNsaWNrXHJcbiAgKTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFdmVudCBIYW5kbGVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gUHJvZmlsZSBFZGl0IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdCh1c2VyRGF0YSkge1xyXG4gIHByb2ZpbGVFZGl0UG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5lZGl0VXNlckluZm8odXNlckRhdGEpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVJbmZvLnNldFVzZXJJbmZvKHsgbmFtZTogcmVzLm5hbWUsIGRlc2NyaXB0aW9uOiByZXMuYWJvdXQgfSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcHJvZmlsZUVkaXRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG4gIHByb2ZpbGVFZGl0UG9wdXAuY2xvc2UoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZEFkZFN1Ym1pdChmb3JtVmFsdWVzKSB7XHJcbiAgY29uc3QgbmFtZSA9IGZvcm1WYWx1ZXMudGl0bGU7XHJcbiAgY29uc3QgbGluayA9IGZvcm1WYWx1ZXMubGluaztcclxuICBjYXJkQWRkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5hZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KVxyXG5cclxuICAgIC50aGVuKChjYXJkKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkKTtcclxuICAgICAgY2FyZExpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgY2FyZEFkZFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcblxyXG4gIGNhcmRBZGRQb3B1cC5jbG9zZSgpO1xyXG4gIGNhcmRBZGRGb3JtLnJlc2V0KCk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbY2FyZEFkZEZvcm0uZ2V0QXR0cmlidXRlKFwiaWRcIildLmRpc2FibGVCdXR0b24oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRWRpdFN1Ym1pdCh1c2VyRGF0YSkge1xyXG4gIGF2YXRhckVkaXRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRVc2VyQXZhdGFyKHVzZXJEYXRhKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBwcm9maWxlSW5mby5zZXRVc2VyQXZhdGFyKHsgYXZhdGFyOiByZXMuYXZhdGFyIH0pO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGF2YXRhckVkaXRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG4gIGF2YXRhckVkaXRQb3B1cC5jbG9zZSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkKSB7XHJcbiAgZGVsZXRlQ29uZmlybVBvcHVwLm9wZW4oKTtcclxuICBkZWxldGVDb25maXJtUG9wdXAuY29uZmlybURlbGV0ZSgoKSA9PiB7XHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5nZXRJZCgpKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XHJcbiAgICAgICAgZGVsZXRlQ29uZmlybVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNhcmQgZGVsZXRpb24gQVBJIGZhaWxlZDpcIiwgZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcclxuICBjb25zdCBjdXJyZW50U3RhdHVzID1cclxuICAgIGNhcmQuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZV9hY3RpdmVcIik7XHJcbiAgY29uc3QgbWV0aG9kID0gY3VycmVudFN0YXR1cyA/IFwiREVMRVRFXCIgOiBcIlBVVFwiO1xyXG4gIGFwaVxyXG4gICAgLnNldENhcmRMaWtlKGNhcmQuZ2V0SWQoKSwgbWV0aG9kKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBjYXJkLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlX2FjdGl2ZVwiKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiTGlrZSBCdXR0b24gRXJyb3JcIiwgZXJyKTtcclxuICAgIH0pO1xyXG59XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50IExpc3RlbmVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBQcm9maWxlIEVkaXQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZmlsbFByb2ZpbGVGb3JtKCk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbcHJvZmlsZUVkaXRGb3JtLmdldEF0dHJpYnV0ZShcImlkXCIpXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBwcm9maWxlRWRpdFBvcHVwLm9wZW4oKTtcclxufSk7XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ2FyZCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNhcmRBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjYXJkQWRkUG9wdXAub3BlbigpO1xyXG59KTtcclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBBdmF0YXIgRWRpdCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGF2YXRhckVkaXRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIERlbGV0ZUNhcmQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjoke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFVzZXIgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJJbmZvKHVzZXJEYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgICAgICBhYm91dDogdXNlckRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGVkaXRVc2VyQXZhdGFyKHVzZXJEYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogdXNlckRhdGEuYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ2FyZCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChjYXJkRGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogY2FyZERhdGEubmFtZSxcclxuICAgICAgICBsaW5rOiBjYXJkRGF0YS5saW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJRCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBMaWtlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbiAgc2V0Q2FyZExpa2UoY2FyZElELCBtZXRob2QpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogbWV0aG9kLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcbiAgZ2V0QXBwSW5mbygpIHt9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3RvciwgZGVzY3JpcHRpb25TZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuICBzZXRVc2VySW5mbyh1c2VyRGF0YSkge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmRlc2NyaXB0aW9uO1xyXG4gIH1cclxuICBzZXRVc2VyQXZhdGFyKHVzZXJEYXRhKSB7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZXhoaWJpdC1pbWFnZVwiKTtcclxuICB9XHJcblxyXG4gIC8vIG9wZW4oZGF0YSkge1xyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19leGhpYml0LWltYWdlLW5hbWVcIikudGV4dENvbnRlbnQgPVxyXG4gICAgICBuYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fcG9wdXBCdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9wb3B1cEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiWWVzXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb25maXJtRGVsZXRlKGFwaUNoZWNrKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gYXBpQ2hlY2s7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjbGFzc1NlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjbGFzc1NlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKGVsZW1lbnRzKSB7XHJcbiAgICBlbGVtZW50cy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsInRoaXMiLCJfZGF0YSIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJjYXJkSWQiLCJfaWQiLCJfaXNsaWtlIiwiaXNsaWtlIiwiX2dldFRlbXBsYXRlIiwiX2NhcmRFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9pbWFnZUVsZW1lbnQiLCJnZW5lcmF0ZUNhcmQiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsInJlbW92ZUNhcmQiLCJyZW1vdmUiLCJnZXRJZCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zdWJtaXRCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwiY2xhc3NMaXN0IiwiZGlzYWJsZWQiLCJkaXNhYmxlQnV0dG9uIiwiYWRkIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dEVscyIsImV2ZXJ5IiwiaW5wdXRFbCIsInZhbGlkaXR5IiwidmFsaWQiLCJfc2hvd0lucHV0RXJyb3IiLCJfZXJyb3JNZXNzYWdlRWwiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9zZXRFdmVudExpc3RlbmVyIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwiUG9wdXAiLCJfcmVmIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVjc0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfcG9wdXBJbnB1dHMiLCJfcG9wdXBCdXR0b24iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsImNvbnNvbGUiLCJsb2ciLCJfc2V0SW5wdXRWYWx1ZXMiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0Rm9ybSIsImNhcmRBZGRCdXR0b24iLCJjYXJkQWRkRm9ybSIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJhdmF0YXJFZGl0QnV0dG9uIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJlZGl0VXNlckluZm8iLCJ1c2VyRGF0YSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJkZXNjcmlwdGlvbiIsImVkaXRVc2VyQXZhdGFyIiwiYXZhdGFyIiwiZ2V0SW5pdGlhbENhcmRzIiwiYWRkTmV3Q2FyZCIsImNhcmREYXRhIiwiZGVsZXRlQ2FyZCIsImNhcmRJRCIsInNldENhcmRMaWtlIiwiZ2V0QXBwSW5mbyIsImF1dGhvcml6YXRpb24iLCJmb3JtVmFsaWRhdG9ycyIsImNvbmZpZyIsIkFycmF5IiwiZnJvbSIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwicHJvZmlsZUluZm8iLCJuYW1lU2VsZWN0b3IiLCJkZXNjcmlwdGlvblNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50Iiwiam9iIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiY2F0Y2giLCJlcnIiLCJlcnJvciIsInByb2ZpbGVFZGl0UG9wdXAiLCJmaW5hbGx5IiwiY2FyZEFkZFBvcHVwIiwidGl0bGUiLCJjYXJkIiwiY2FyZEVsZW1lbnQiLCJjcmVhdGVDYXJkIiwiY2FyZExpc3QiLCJhZGRJdGVtIiwicmVzZXQiLCJhdmF0YXJFZGl0UG9wdXAiLCJjYXJkSW1hZ2VQb3B1cCIsIl9jYXJkSW1hZ2UiLCJkZWxldGVDb25maXJtUG9wdXAiLCJjb25maXJtRGVsZXRlIiwiYXBpQ2hlY2siLCJjbGFzc1NlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJlbGVtZW50cyIsIml0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIml0ZW1zIiwiY29udGFpbnMiLCJ0b2dnbGUiLCJtYXAiLCJmaWxsUHJvZmlsZUZvcm0iXSwic291cmNlUm9vdCI6IiJ9