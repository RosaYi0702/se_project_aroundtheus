!function(){"use strict";class e{constructor(e,t,s,r,n){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=r,this._handleLikeClick=n,this.cardId=e._id,this._isLiked=e.isLiked}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__like"),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardElement.querySelector(".card__trash").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._imageElement.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)}))}generateCard(){return this._cardElement=this._getTemplate(),this._imageElement=this._cardElement.querySelector(".card__image"),this._imageElement.src=this._link,this._imageElement.alt=this._name,this._cardElement.querySelector(".card__name").textContent=this._name,this._setEventListeners(),this.updateLikeButton(),this._cardElement}removeCard(){this._cardElement.remove(),this._cardElement=null}getId(){return this.cardId}getLikeMethod(){return this._currentStatus=this._likeButton.classList.contains("card__like_active"),console.log(this._currentStatus),this._currentStatus?"DELETE":"PUT"}updateLikeButton(){return this._isLiked?this._likeButton.classList.add("card__like_active"):this._likeButton.classList.remove("card__like_active")}updateLiked(e){this._isLiked=e,this.updateLikeButton()}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._submitButton=this._formElement.querySelector(this._submitButtonSelector)}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}_showInputError(e){this._errorMessageEl=this._formElement.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageEl.textContent=e.validationMessage,this._errorMessageEl.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageEl=this._formElement.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageEl.textContent=e.validationMessage,this._errorMessageEl.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_toggleButtonState(){this._hasInvalidInput(this._inputEls)?this.disableButton():this._enableButton()}_setEventListener(){this._inputEls=[...this._formElement.querySelectorAll(this._inputSelector)],this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._formElement.addEventListener("submit",(e=>{e.preventDefault()}))}resetValidation(){this._inputEls.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListener()}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEcsClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEcsClose)}_handleEcsClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.querySelector("#modal-close-button").addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()}))}}class r extends s{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._popupInputs=this._popupForm.querySelectorAll(".modal__input"),this._popupButton=this._popupForm.querySelector(".modal__button"),this._handleFormSubmit=s,this._submitBtnText=this._popupButton.textContent}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._popupButton.textContent=e?t:this._submitBtnText}_getInputValues(){const e={};return this._popupInputs.forEach((t=>{e[t.name]=t.value})),console.log("Form Input Values:",e),e}_setInputValues(e){this._popupInputs.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}}const n=document.querySelector("#profile-edit-button"),i=document.querySelector("#profile-form"),o=document.querySelector("#card-add-button"),a=document.querySelector("#add-card-form"),l=document.querySelector("#profile-title-input"),d=document.querySelector("#profile-description-input"),c=document.querySelector("#avatar-edit-button"),u=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_request(e,t){return fetch(e,t).then(this._checkResponse)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error:${e.status}`)}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers})}editUserInfo(e){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.description})})}editUserAvatar(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})})}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers})}addNewCard(e){return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})})}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}setCardLike(e,t){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:t,headers:this._headers})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"556b7174-cdb9-4bbc-853b-d91bc60928df","Content-Type":"application/json"}}),h={};function _(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...",r=arguments.length>3?arguments[3]:void 0;e.renderLoading(!0,s),t().then((()=>{r&&r(),e.close()})).catch((e=>{console.error(e)})).finally((()=>{e.renderLoading(!1)}))}var m;m={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(m.formSelector)).forEach((e=>{const s=new t(m,e),r=e.getAttribute("id");h[r]=s,s.enableValidation()}));const p=new class{constructor(e,t,s){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.name,this._jobElement.textContent=e.description}setUserAvatar(e){this._avatarElement.src=e.avatar}}(".profile__name",".profile__description",".profile__avatar");u.getUserInfo().then((e=>{p.setUserInfo({name:e.name,description:e.about})})).catch((e=>{console.error(e)}));const E=new r({popupSelector:"#profile-edit-modal",handleFormSubmit:function(e){_(E,(function(){return u.editUserInfo(e).then((e=>{p.setUserInfo({name:e.name,description:e.about})}))}))}});E.setEventListeners(),n.addEventListener("click",(()=>{!function(){const e=p.getUserInfo();l.value=e.name,d.value=e.job}(),h[i.getAttribute("id")].resetValidation(),E.open()})),u.getUserInfo().then((e=>{console.log("get res",e),p.setUserAvatar({avatar:e.avatar})})).catch((e=>{console.error(e)}));const v=new r({popupSelector:"#profile-avatar-modal",handleFormSubmit:function(e){_(v,(function(){return u.editUserAvatar(e).then((e=>{p.setUserAvatar({avatar:e.avatar})}))}))}});function S(t){return new e(t,"#card-template",L,C,y).generateCard()}v.setEventListeners(),c.addEventListener("click",(()=>{v.open()}));const b=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:e=>{b.addItem(e)}},".cards__list");u.getInitialCards().then((e=>{console.log("data",e);const t=e.map((e=>S(e)));b.renderItems(t)})).catch((e=>{console.error(e)}));const g=new r({popupSelector:"#card-add-modal",handleFormSubmit:function(e){const t=e.title,s=e.link;_(g,(function(){return u.addNewCard({name:t,link:s}).then((e=>{const t=S(e);b.addItem(t)}))}),"Saving...",(()=>{a.reset()})),h[a.getAttribute("id")].disableButton()}});g.setEventListeners(),o.addEventListener("click",(()=>{g.open()}));const f=new class extends s{constructor(e){super({popupSelector:e}),this._cardImage=this._popupElement.querySelector(".modal__exhibit-image")}open(e,t){this._cardImage.src=t,this._cardImage.alt=e,this._popupElement.querySelector(".modal__exhibit-image-name").textContent=e,super.open()}}("#image-modal");function L(e,t){f.open(e,t)}f.setEventListeners();const k=new class extends s{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._popupButton=this._popupElement.querySelector(".modal__button")}renderLoading(e){this._popupButton.textContent=e?"Deleting...":"Yes"}confirmDelete(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._popupButton.addEventListener("click",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}({popupSelector:"#confirmation-modal",handleFormSubmit:C});function C(e){k.open(),k.confirmDelete((()=>{u.deleteCard(e.getId()).then((()=>{e.removeCard(),k.close()})).catch((e=>{console.error("Card deletion API failed:",e)}))}))}function y(e){u.setCardLike(e.getId(),e.getLikeMethod()).then((t=>{console.log("card get like method",e.getLikeMethod()),console.log(t),e.updateLiked(t.isLiked)})).catch((e=>{console.error("Like Button Error",e)}))}k.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S0FBS2tHLG1CQUFtQixHQUU1QixHTjBNbUQsQ0FDbkRqQixjQUFlLHNCQUNmWSxpQkFBa0IvRixJQUlwQixTQUFTQSxFQUFrQnVNLEdBQ3pCSSxFQUFtQnRILE9BQ25Cc0gsRUFBbUJDLGVBQWMsS0FDL0JwRixFQUNHK0IsV0FBV2dELEVBQUt2SyxTQUNoQmlHLE1BQUssS0FDSnNFLEVBQUt6SyxhQUNMNkssRUFBbUJwSCxPQUFPLElBRTNCd0UsT0FBT0MsSUFDTjNILFFBQVE0SCxNQUFNLDRCQUE2QkQsRUFBSSxHQUMvQyxHQUVSLENBR0EsU0FBUy9KLEVBQWdCc00sR0FDdkIvRSxFQUNHaUMsWUFBWThDLEVBQUt2SyxRQUFTdUssRUFBS3RLLGlCQUMvQmdHLE1BQU1FLElBQ0w5RixRQUFRQyxJQUFJLHVCQUF3QmlLLEVBQUt0SyxpQkFDekNJLFFBQVFDLElBQUk2RixHQUNab0UsRUFBSy9KLFlBQVkyRixFQUFJckgsUUFBUSxJQUU5QmlKLE9BQU9DLElBQ04zSCxRQUFRNEgsTUFBTSxvQkFBcUJELEVBQUksR0FFN0MsQ0E3QkEyQyxFQUFtQmhILG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9hcGkuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cHdpdGhDb25maXJtYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBkYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlTGlrZUNsaWNrXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcclxuXHJcbiAgICB0aGlzLmNhcmRJZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcclxuICB9XHJcblxyXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBfZ2V0VGVtcGxhdGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIF9zZXRFdmVudExpc3RlbmVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvL2xpa2UgYnV0dG9uXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlXCIpO1xyXG5cclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgLy8gdGhpcy5faGFuZGxlTGlrZUJ1dHRvbigpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcyk7XHJcbiAgICB9KTtcclxuICAgIC8vdHJhc2hcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvL2V4aGliaXRcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gZ2VuZXJhdGVDYXJkIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19uYW1lXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLnVwZGF0ZUxpa2VCdXR0b24oKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICByZW1vdmVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBnZXRJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLmNhcmRJZDtcclxuICB9XHJcblxyXG4gIGdldExpa2VNZXRob2QoKSB7XHJcbiAgICB0aGlzLl9jdXJyZW50U3RhdHVzID1cclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlX2FjdGl2ZVwiKTtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMuX2N1cnJlbnRTdGF0dXMpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRTdGF0dXMgPyBcIkRFTEVURVwiIDogXCJQVVRcIjtcclxuICB9XHJcbiAgdXBkYXRlTGlrZUJ1dHRvbigpIHtcclxuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICB9XHJcbiAgdXBkYXRlTGlrZWQoaXNMaWtlZCkge1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XHJcbiAgICB0aGlzLnVwZGF0ZUxpa2VCdXR0b24oKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBzZXR0aW5ncy5mb3JtU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbHMuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWwuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsLmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRFbHMpKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcigpIHtcclxuICAgIHRoaXMuX2lucHV0RWxzID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFY3NDbG9zZSk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFY3NDbG9zZSk7XHJcbiAgfVxyXG4gIF9oYW5kbGVFY3NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWNsb3NlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9wb3B1cElucHV0cyA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICAgIHRoaXMuX3BvcHVwQnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fc3VibWl0QnRuVGV4dCA9IHRoaXMuX3BvcHVwQnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9wb3B1cEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fcG9wdXBCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdG5UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX3BvcHVwSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2coXCJGb3JtIElucHV0IFZhbHVlczpcIiwgZm9ybVZhbHVlcyk7XHJcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIF9zZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICB0aGlzLl9wb3B1cElucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XHJcbiAgICB9KTtcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW1wb3J0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMsIGNvbmZpZyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvYXBpLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwd2l0aENvbmZpcm1hdGlvbi5qc1wiO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VkIGNvbnN0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1mb3JtXCIpO1xyXG5jb25zdCBjYXJkQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWFkZC1idXR0b25cIik7XHJcbmNvbnN0IGNhcmRBZGRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xyXG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxyXG4pO1xyXG5jb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItZWRpdC1idXR0b25cIik7XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHZW5lcmFsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEFwaSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjU1NmI3MTc0LWNkYjktNGJiYy04NTNiLWQ5MWJjNjA5MjhkZlwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBGb3JtVmFsaWRhdG9yKEZvcm0pIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtRWxlbWVudCk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcImlkXCIpO1xyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oY29uZmlnKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBIYW5kbGVTdWJtaXQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmZ1bmN0aW9uIGhhbmRsZVN1Ym1pdChcclxuICBwb3B1cFNlbGVjdG9yLFxyXG4gIHJlcXVlc3QsXHJcbiAgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiLFxyXG4gIGNhbGxiYWNrXHJcbikge1xyXG4gIHBvcHVwU2VsZWN0b3IucmVuZGVyTG9hZGluZyh0cnVlLCBsb2FkaW5nVGV4dCk7XHJcbiAgcmVxdWVzdCgpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGlmIChjYWxsYmFjaykge1xyXG4gICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgIH1cclxuICAgICAgcG9wdXBTZWxlY3Rvci5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHBvcHVwU2VsZWN0b3IucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFByb2ZpbGUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gVXNlckluZm8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgcHJvZmlsZUluZm8gPSBuZXcgVXNlckluZm8oXHJcbiAgXCIucHJvZmlsZV9fbmFtZVwiLFxyXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbiAgXCIucHJvZmlsZV9fYXZhdGFyXCJcclxuKTtcclxuXHJcbmFwaVxyXG4gIC5nZXRVc2VySW5mbygpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgcHJvZmlsZUluZm8uc2V0VXNlckluZm8oeyBuYW1lOiByZXMubmFtZSwgZGVzY3JpcHRpb246IHJlcy5hYm91dCB9KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgfSk7XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBQcm9maWxlUG9wdXAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgcHJvZmlsZUVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdCxcclxufSk7XHJcbnByb2ZpbGVFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGZpbGxQcm9maWxlRm9ybSgpIHtcclxuICBjb25zdCB1c2VyRGF0YSA9IHByb2ZpbGVJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VyRGF0YS5uYW1lO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckRhdGEuam9iO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdCh1c2VyRGF0YSkge1xyXG4gIGZ1bmN0aW9uIGVkaXRVc2VySW5mb1JlcXVlc3QoKSB7XHJcbiAgICByZXR1cm4gYXBpLmVkaXRVc2VySW5mbyh1c2VyRGF0YSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVJbmZvLnNldFVzZXJJbmZvKHsgbmFtZTogcmVzLm5hbWUsIGRlc2NyaXB0aW9uOiByZXMuYWJvdXQgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgaGFuZGxlU3VibWl0KHByb2ZpbGVFZGl0UG9wdXAsIGVkaXRVc2VySW5mb1JlcXVlc3QpO1xyXG59XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZpbGxQcm9maWxlRm9ybSgpO1xyXG4gIGZvcm1WYWxpZGF0b3JzW3Byb2ZpbGVFZGl0Rm9ybS5nZXRBdHRyaWJ1dGUoXCJpZFwiKV0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgcHJvZmlsZUVkaXRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBhdmF0YXJQb3B1cCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuYXBpXHJcbiAgLmdldFVzZXJJbmZvKClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhcImdldCByZXNcIiwgcmVzKTtcclxuICAgIHByb2ZpbGVJbmZvLnNldFVzZXJBdmF0YXIoeyBhdmF0YXI6IHJlcy5hdmF0YXIgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gIH0pO1xyXG5cclxuY29uc3QgYXZhdGFyRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI3Byb2ZpbGUtYXZhdGFyLW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlQXZhdGFyRWRpdFN1Ym1pdCxcclxufSk7XHJcblxyXG5hdmF0YXJFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckVkaXRTdWJtaXQodXNlckRhdGEpIHtcclxuICBmdW5jdGlvbiBlZGl0VXNlckF2YXRhclJlcXVlc3QoKSB7XHJcbiAgICByZXR1cm4gYXBpLmVkaXRVc2VyQXZhdGFyKHVzZXJEYXRhKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcHJvZmlsZUluZm8uc2V0VXNlckF2YXRhcih7IGF2YXRhcjogcmVzLmF2YXRhciB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBoYW5kbGVTdWJtaXQoYXZhdGFyRWRpdFBvcHVwLCBlZGl0VXNlckF2YXRhclJlcXVlc3QpO1xyXG59XHJcblxyXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYXZhdGFyRWRpdFBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhcmQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIENhcmQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZERhdGEsXHJcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICApO1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ2FyZExpc3QgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICByZW5kZXJlcjogKGl0ZW1zKSA9PiB7XHJcbiAgICAgIGNhcmRMaXN0LmFkZEl0ZW0oaXRlbXMpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIFwiLmNhcmRzX19saXN0XCJcclxuKTtcclxuXHJcbmZ1bmN0aW9uIGNhcmRMaXN0RGF0YSgpIHtcclxuICByZXR1cm4gYXBpXHJcbiAgICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiZGF0YVwiLCBkYXRhKTtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkYXRhLm1hcCgoY2FyZERhdGEpID0+IGNyZWF0ZUNhcmQoY2FyZERhdGEpKTtcclxuICAgICAgY2FyZExpc3QucmVuZGVySXRlbXMoY2FyZEVsZW1lbnQpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5jYXJkTGlzdERhdGEoKTtcclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGNhcmRBZGRQb3B1cCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbmNvbnN0IGNhcmRBZGRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNjYXJkLWFkZC1tb2RhbFwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZUNhcmRBZGRTdWJtaXQsXHJcbn0pO1xyXG5jYXJkQWRkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNhcmRBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjYXJkQWRkUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRBZGRTdWJtaXQoZm9ybVZhbHVlcykge1xyXG4gIGNvbnN0IG5hbWUgPSBmb3JtVmFsdWVzLnRpdGxlO1xyXG4gIGNvbnN0IGxpbmsgPSBmb3JtVmFsdWVzLmxpbms7XHJcbiAgZnVuY3Rpb24gYWRkTmV3Q2FyZFJlcXVlc3QoKSB7XHJcbiAgICByZXR1cm4gYXBpLmFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pLnRoZW4oKGNhcmQpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGNhcmQpO1xyXG4gICAgICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBoYW5kbGVTdWJtaXQoY2FyZEFkZFBvcHVwLCBhZGROZXdDYXJkUmVxdWVzdCwgXCJTYXZpbmcuLi5cIiwgKCkgPT4ge1xyXG4gICAgY2FyZEFkZEZvcm0ucmVzZXQoKTtcclxuICB9KTtcclxuICBmb3JtVmFsaWRhdG9yc1tjYXJkQWRkRm9ybS5nZXRBdHRyaWJ1dGUoXCJpZFwiKV0uZGlzYWJsZUJ1dHRvbigpO1xyXG59XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBjYXJkSW1hZ2VQb3B1cC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IGNhcmRJbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLW1vZGFsXCIpO1xyXG5jYXJkSW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhuYW1lLCBsaW5rKSB7XHJcbiAgY2FyZEltYWdlUG9wdXAub3BlbihuYW1lLCBsaW5rKTtcclxufVxyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIERlbGV0ZUNvbmZpcm1Qb3B1cCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgZGVsZXRlQ29uZmlybVBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbih7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjY29uZmlybWF0aW9uLW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbn0pO1xyXG5kZWxldGVDb25maXJtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGNhcmQpIHtcclxuICBkZWxldGVDb25maXJtUG9wdXAub3BlbigpO1xyXG4gIGRlbGV0ZUNvbmZpcm1Qb3B1cC5jb25maXJtRGVsZXRlKCgpID0+IHtcclxuICAgIGFwaVxyXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLmdldElkKCkpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcclxuICAgICAgICBkZWxldGVDb25maXJtUG9wdXAuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ2FyZCBkZWxldGlvbiBBUEkgZmFpbGVkOlwiLCBlcnIpO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gTGlrZUNhcmQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcclxuICBhcGlcclxuICAgIC5zZXRDYXJkTGlrZShjYXJkLmdldElkKCksIGNhcmQuZ2V0TGlrZU1ldGhvZCgpKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhcImNhcmQgZ2V0IGxpa2UgbWV0aG9kXCIsIGNhcmQuZ2V0TGlrZU1ldGhvZCgpKTtcclxuICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgY2FyZC51cGRhdGVMaWtlZChyZXMuaXNMaWtlZCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkxpa2UgQnV0dG9uIEVycm9yXCIsIGVycik7XHJcbiAgICB9KTtcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX3JlcXVlc3QodXJsLCBvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjoke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFVzZXIgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJJbmZvKHVzZXJEYXRhKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiB1c2VyRGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRVc2VyQXZhdGFyKHVzZXJEYXRhKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiB1c2VyRGF0YS5hdmF0YXIsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ2FyZCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChjYXJkRGF0YSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBjYXJkRGF0YS5uYW1lLFxyXG4gICAgICAgIGxpbms6IGNhcmREYXRhLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJRCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSUR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBMaWtlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbiAgc2V0Q2FyZExpa2UoY2FyZElELCBtZXRob2QpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBtZXRob2QsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3RvciwgZGVzY3JpcHRpb25TZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuICBzZXRVc2VySW5mbyh1c2VyRGF0YSkge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmRlc2NyaXB0aW9uO1xyXG4gIH1cclxuICBzZXRVc2VyQXZhdGFyKHVzZXJEYXRhKSB7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjbGFzc1NlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjbGFzc1NlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKGVsZW1lbnRzKSB7XHJcbiAgICBlbGVtZW50cy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19leGhpYml0LWltYWdlXCIpO1xyXG4gIH1cclxuXHJcbiAgLy8gb3BlbihkYXRhKSB7XHJcbiAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2V4aGliaXQtaW1hZ2UtbmFtZVwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9wb3B1cEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3BvcHVwQnV0dG9uLnRleHRDb250ZW50ID0gXCJZZXNcIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNvbmZpcm1EZWxldGUoYXBpQ2hlY2spIHtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBhcGlDaGVjaztcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiY2FyZElkIiwiX2lkIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX2dldFRlbXBsYXRlIiwiX2NhcmRFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9pbWFnZUVsZW1lbnQiLCJnZW5lcmF0ZUNhcmQiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsInVwZGF0ZUxpa2VCdXR0b24iLCJyZW1vdmVDYXJkIiwicmVtb3ZlIiwiZ2V0SWQiLCJnZXRMaWtlTWV0aG9kIiwiX2N1cnJlbnRTdGF0dXMiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImNvbnNvbGUiLCJsb2ciLCJhZGQiLCJ1cGRhdGVMaWtlZCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zdWJtaXRCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJkaXNhYmxlQnV0dG9uIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dEVscyIsImV2ZXJ5IiwiaW5wdXRFbCIsInZhbGlkaXR5IiwidmFsaWQiLCJfc2hvd0lucHV0RXJyb3IiLCJfZXJyb3JNZXNzYWdlRWwiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9zZXRFdmVudExpc3RlbmVyIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwiUG9wdXAiLCJfcmVmIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVjc0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfcG9wdXBJbnB1dHMiLCJfcG9wdXBCdXR0b24iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9zdWJtaXRCdG5UZXh0IiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJfc2V0SW5wdXRWYWx1ZXMiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0Rm9ybSIsImNhcmRBZGRCdXR0b24iLCJjYXJkQWRkRm9ybSIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJhdmF0YXJFZGl0QnV0dG9uIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX3JlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJ0aGVuIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJtZXRob2QiLCJlZGl0VXNlckluZm8iLCJ1c2VyRGF0YSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJkZXNjcmlwdGlvbiIsImVkaXRVc2VyQXZhdGFyIiwiYXZhdGFyIiwiZ2V0SW5pdGlhbENhcmRzIiwiYWRkTmV3Q2FyZCIsImNhcmREYXRhIiwiZGVsZXRlQ2FyZCIsImNhcmRJRCIsInNldENhcmRMaWtlIiwiYXV0aG9yaXphdGlvbiIsImZvcm1WYWxpZGF0b3JzIiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsImNhbGxiYWNrIiwiY2F0Y2giLCJlcnIiLCJlcnJvciIsImZpbmFsbHkiLCJjb25maWciLCJBcnJheSIsImZyb20iLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsInByb2ZpbGVJbmZvIiwibmFtZVNlbGVjdG9yIiwiZGVzY3JpcHRpb25TZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsImpvYiIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsInByb2ZpbGVFZGl0UG9wdXAiLCJmaWxsUHJvZmlsZUZvcm0iLCJhdmF0YXJFZGl0UG9wdXAiLCJjcmVhdGVDYXJkIiwiY2FyZExpc3QiLCJjbGFzc1NlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJlbGVtZW50cyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJpdGVtcyIsImNhcmRFbGVtZW50IiwibWFwIiwiY2FyZEFkZFBvcHVwIiwidGl0bGUiLCJjYXJkIiwicmVzZXQiLCJjYXJkSW1hZ2VQb3B1cCIsIl9jYXJkSW1hZ2UiLCJkZWxldGVDb25maXJtUG9wdXAiLCJjb25maXJtRGVsZXRlIiwiYXBpQ2hlY2siXSwic291cmNlUm9vdCI6IiJ9